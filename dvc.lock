schema: '2.0'
stages:
  data_preprocessing:
    cmd: python src/data_preprocessing.py
    deps:
    - path: data/raw
      hash: md5
      md5: a5a756758347e525f680d52c43929bfc.dir
      size: 5572687
      nfiles: 9
    - path: src/data_preprocessing.py
      hash: md5
      md5: 9a3c29fded105ec3e4a1c4ac73dac87c
      size: 9681
    outs:
    - path: data/processed_cookbook.pkl
      hash: md5
      md5: 0b2688e813054544800b46813e422608
      size: 3653739
  model_training:
    cmd: python src/model_training.py
    deps:
    - path: data/processed_cookbook.pkl
      hash: md5
      md5: 0b2688e813054544800b46813e422608
      size: 3653739
    - path: src/model_training.py
      hash: md5
      md5: 5f4d86ea8b4258f60cf7ff945db04a38
      size: 6194
    params:
      params.yaml:
        model_pipeline:
          model_path: models/fasttext.model
          recipe_path: data/processed_cookbook.pkl
          fast_text:
            vector_size: 100
            window: 8
            sg: 0
            epochs: 100
            seed: 1234
            min_count: 1
            bucket: 50000
          model_scoring:
            w_title: 0.2
            w_cosine: 0.2
            w_maxsim: 0.6
            idf_top_weights:
            - 0.8
            - 0.1
            - 0.1
    outs:
    - path: models/fasttext.model
      hash: md5
      md5: e01017835b262c29c9aefe1dc87c580c
      size: 27935088
    - path: training_metadata.json
      hash: md5
      md5: 63db156bb9c5467cab2983fafffaf2c3
      size: 858
  model_evaluation:
    cmd: python src/model_evaluation.py
    deps:
    - path: src/model_evaluation.py
      hash: md5
      md5: c654163bd79d1295cca28b22aef03dc1
      size: 4742
    - path: training_metadata.json
      hash: md5
      md5: 63db156bb9c5467cab2983fafffaf2c3
      size: 858
    params:
      params.yaml:
        model_evaluation:
          seed: 42
          k: 10
          relevant_thresh: 0.5
    outs:
    - path: validation_metadata.json
      hash: md5
      md5: fafb5f0bb4d41f6dcd5469f89ba20d61
      size: 1231
  model_registering:
    cmd: python src/model_registering.py
    deps:
    - path: src/model_registering.py
      hash: md5
      md5: cc4fa647a411c14f744e7f1e6894a3bf
      size: 3013
    - path: validation_metadata.json
      hash: md5
      md5: fafb5f0bb4d41f6dcd5469f89ba20d61
      size: 1231
    params:
      params.yaml:
        model_register:
          max_runs: 3
