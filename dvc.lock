schema: '2.0'
stages:
  model_training:
    cmd: python src/model_training.py
    deps:
    - path: data/processed_cookbook.pkl
      hash: md5
      md5: 337d78ce962a69fdd80ceb4a2d905b16
      size: 3565277
    - path: src/model_training.py
      hash: md5
      md5: f912f0044b21c66523a466ae4fb280c9
      size: 6327
    params:
      params.yaml:
        model_pipeline:
          model_path: models/fasttext.model
          model_ngram_path: models/fasttext.model.wv.vectors_ngrams.npy
          recipe_path: data/processed_cookbook.pkl
          fast_text:
            vector_size: 100
            window: 8
            sg: 0
            epochs: 100
          model_scoring:
            w_title: 0.2
            w_cosine: 0.2
            w_maxsim: 0.6
            idf_top_weights:
            - 0.8
            - 0.1
            - 0.1
    outs:
    - path: models/fasttext.model
      hash: md5
      md5: c778b590e74be07aabda38824fee2538
      size: 1058643
    - path: models/fasttext.model.wv.vectors_ngrams.npy
      hash: md5
      md5: 288d889a5a943277ed54b939bb57e227
      size: 800000128
    - path: training_metadata.json
      hash: md5
      md5: ec05d060f6936d9d8c5d89b6ba3c7dce
      size: 850
  model_evaluation:
    cmd: python src/model_evaluation.py
    deps:
    - path: src/model_evaluation.py
      hash: md5
      md5: 3201934698533a83505292a9a7a30b58
      size: 4741
    - path: training_metadata.json
      hash: md5
      md5: ec05d060f6936d9d8c5d89b6ba3c7dce
      size: 850
    params:
      params.yaml:
        model_evaluation:
          seed: 42
          k: 10
          relevant_thresh: 0.5
    outs:
    - path: validation_metadata.json
      hash: md5
      md5: 8e032e76a603127e44af5e31cf36e3b7
      size: 1237
  model_registering:
    cmd: python src/model_registering.py
    deps:
    - path: src/model_registering.py
      hash: md5
      md5: be16a7db2f2192b666367bde204fb3c4
      size: 3718
    - path: validation_metadata.json
      hash: md5
      md5: 8e032e76a603127e44af5e31cf36e3b7
      size: 1237
    params:
      params.yaml:
        model_register:
          max_runs: 3
  data_preprocessing:
    cmd: python src/data_preprocessing.py
    deps:
    - path: data/raw
      hash: md5
      md5: a5a756758347e525f680d52c43929bfc.dir
      size: 5572687
      nfiles: 9
    - path: src/data_preprocessing.py
      hash: md5
      md5: e2895c96cd3bbb7c84d1c3bcb480de1b
      size: 9328
    outs:
    - path: data/processed_cookbook.pkl
      hash: md5
      md5: 337d78ce962a69fdd80ceb4a2d905b16
      size: 3565277
